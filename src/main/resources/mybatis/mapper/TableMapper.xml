<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.ts.cpfr.dao.TableDao">
	<select id="selectLastInsertID" resultType="int">
		SELECT LAST_INSERT_ID()
	</select>
	<update id="createTableWarehouse" parameterType="int">
		CREATE TABLE IF NOT EXISTS `tbl_${value}_device` (
		  `device_id` int(8) NOT NULL AUTO_INCREMENT COMMENT '设备ID',
		  `group_id` int(8) NOT NULL DEFAULT '0' COMMENT '组ID',
		  `device_name` varchar(20) NOT NULL COMMENT '设备名称',
		  `device_sn` varchar(50) DEFAULT NULL COMMENT '设备sn号/设备指纹',
		  `status` tinyint(2) DEFAULT NULL COMMENT '设备状态信息 1:开闸 2:关闸 3:重启',
		  `mac_grant_key` varchar(50) DEFAULT NULL COMMENT '百度mac授权ID',
		  `last_online_time` datetime DEFAULT NULL COMMENT '最后一次上线时间(单位:秒)',
		  `last_offine_time` datetime DEFAULT NULL COMMENT '最后一次下线时间(单位:秒)',
		  `device_ip_address` varchar(20) DEFAULT NULL COMMENT 'IP地址',
		  `online` tinyint(4) NOT NULL DEFAULT '0' COMMENT '设备是否在线 0:不在线 1:在线',
		  `lmt` timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT '最后更新时间',
		  PRIMARY KEY (`device_id`)
		) ENGINE=InnoDB AUTO_INCREMENT=2 DEFAULT CHARSET=utf8;

		CREATE TABLE IF NOT EXISTS `tbl_${value}_person` (
		  `person_id` int(8) NOT NULL AUTO_INCREMENT COMMENT '人员ID',
		  `group_id` int(8) NOT NULL DEFAULT '0' COMMENT '组ID',
		  `name` varchar(20) NOT NULL COMMENT '人名',
		  `emp_number` int(8) NOT NULL DEFAULT '0' COMMENT '工号',
		  `add_time` datetime NOT NULL COMMENT '添加时间(时间戳)',
		  `base_image` varchar(200) NOT NULL COMMENT '存档图片(base64)/本地保存路径',
		  `lmt` timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT '最后更新时间',
		  PRIMARY KEY (`person_id`)
		) ENGINE=InnoDB DEFAULT CHARSET=utf8;

		CREATE TABLE IF NOT EXISTS `tbl_${value}_group` (
		  `group_id` int(8) NOT NULL AUTO_INCREMENT COMMENT '组ID',
		  `gourp_name` varchar(20) NOT NULL COMMENT '组名',
		  `super_id` int(20) NOT NULL COMMENT '父分组ID,为0时表示第一级分组',
		  `type` tinyint(2) NOT NULL COMMENT '分组类型 0:未确定，1:设备分组 ，2:子级分组',
		  `lmt` timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT '最后更新时间',
		  PRIMARY KEY (`group_id`)
		) ENGINE=InnoDB DEFAULT CHARSET=utf8;
	</update>
</mapper>